---
title: ì´ë²¤íŠ¸ ë£¨í”„ (Event Loop)
description: 
published: true
date: 2023-02-17T18:00:38.736Z
tags: nodejs, v8
editor: markdown
dateCreated: 2022-12-26T12:35:42.101Z
---

- [Event Loop***English** version of this document is available*](/en/dev/Nodejs/event-loop)
{.links-list}

## ê°œìš”

Node.js ì´ë²¤íŠ¸ ë£¨í”„ëŠ” Node.jsê°€ ë¹„ì°¨ë‹¨(Non-Blocking) I/O ì‘ì—…ì„ íš¨ìœ¨ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ëŸ°íƒ€ì„ì˜ ê¸°ë³¸ ë¶€ë¶„ì…ë‹ˆë‹¤. ì´ë²¤íŠ¸ ëŒ€ê¸°ì—´ì„ ì§€ì†ì ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•˜ê³  ì²˜ë¦¬í•  ì¤€ë¹„ê°€ ëœ ì´ë²¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤.

- ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ì‹±ê¸€ ìŠ¤ë ˆë“œ ì´ë²¤íŠ¸ ë£¨í”„ì…ë‹ˆë‹¤. ì¦‰, í•œ ë²ˆì— í•˜ë‚˜ì˜ ì´ë²¤íŠ¸ë§Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìœ¼ë©° ì´ë²¤íŠ¸ëŠ” ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ Node.jsëŠ” CPUë¥¼ ë§ì´ ì‚¬ìš©í•˜ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•˜ê±°ë‚˜ ì‹œìŠ¤í…œ í˜¸ì¶œì„ ì°¨ë‹¨í•˜ëŠ” ê²ƒê³¼ ê°™ì€ íŠ¹ì • ìœ í˜•ì˜ ì‘ì—…ì— ì—¬ëŸ¬ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
- Node.js ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‹¤í–‰ë˜ëŠ” ëŒ€ë¶€ë¶„ì˜ JavaScript ì½”ë“œ ì‹¤í–‰ì„ ì´ë²¤íŠ¸ ë£¨í”„ê°€ ë‹´ë‹¹í•©ë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” ì‚¬ìš©ì ì½”ë“œì™€ Node.js ëŸ°íƒ€ì„ ë° í•´ë‹¹ í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì œê³µí•˜ëŠ” ì½”ë“œê°€ ëª¨ë‘ í¬í•¨ë©ë‹ˆë‹¤.
- ë˜í•œ, ë¹„ì°¨ë‹¨í˜•ìœ¼ë¡œ ì„¤ê³„ë˜ì–´ ê° ì´ë²¤íŠ¸ê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ë‹¤ìŒ ì´ë²¤íŠ¸ë¡œ ë„˜ì–´ê°ˆ ë•Œê¹Œì§€ ì´ë²¤íŠ¸ë¥¼ ë™ì‹œì— ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë¹„ì°¨ë‹¨ I/O ì‘ì—… ë° ë¹„ë™ê¸° ì½œë°± í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¬ì„±ë©ë‹ˆë‹¤.
- JavaScriptì™€ ë„¤ì´í‹°ë¸Œ ì½”ë“œì˜ ì¡°í•©ì„ ì‚¬ìš©í•˜ì—¬ ì´ë²¤íŠ¸ ë£¨í”„ê°€ êµ¬í˜„ë©ë‹ˆë‹¤. ì´ë²¤íŠ¸ ë£¨í”„ì˜ JavaScript ë¶€ë¶„ì€ C++ë¡œ ì‘ì„±ë˜ì–´ V8 JavaScript ì—”ì§„ì„ ì‚¬ìš©, ë„¤ì´í‹°ë¸Œ ì½”ë“œë¡œ ì»´íŒŒì¼ë˜ëŠ” ë°˜ë©´ ë„¤ì´í‹°ë¸Œ ë¶€ë¶„ì€ í”Œë«í¼ë³„ APIë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„ë©ë‹ˆë‹¤.
- ì´ë²¤íŠ¸ ë£¨í”„ì—ëŠ” ì—¬ëŸ¬ ë‹¨ê³„ê°€ ìˆìœ¼ë©° ê° ë‹¨ê³„ëŠ” íŠ¹ì • ìœ í˜•ì˜ ì´ë²¤íŠ¸ ì²˜ë¦¬ë¥¼ ë‹´ë‹¹í•©ë‹ˆë‹¤. ë‹¨ê³„ê°€ ì‹¤í–‰ë˜ëŠ” ìˆœì„œëŠ” ì‚¬ìš© ì¤‘ì¸ Node.jsì˜ íŠ¹ì • ë²„ì „ì— ë”°ë¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> ### Non-Blocking I/O ì‘ì—…ì— ëŒ€í•˜ì—¬
>
> Node.jsì—ì„œ ë¹„ì°¨ë‹¨ I/O ì‘ì—…ì€ ì‘ì—…ì´ ì™„ë£Œë˜ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ë™ì•ˆ í”„ë¡œê·¸ë¨ ì‹¤í–‰ì„ ì°¨ë‹¨í•˜ì§€ ì•ŠëŠ” ì‘ì—…ì…ë‹ˆë‹¤. ì´ëŠ” I/O ì‘ì—…ì´ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ìˆ˜í–‰ë˜ëŠ” ë™ì•ˆ í”„ë¡œê·¸ë¨ì´ ê³„ì† ì‹¤í–‰ë˜ê³  ë‹¤ë¥¸ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
>
> Node.jsëŠ” ì„œë²„ ì¸¡ì—ì„œ JavaScriptë¥¼ ì‹¤í–‰í•˜ë„ë¡ ì„¤ê³„ëœ Chrome V8 JavaScript ì—”ì§„ ìœ„ì— Built ë©ë‹ˆë‹¤. Node.jsì˜ ì£¼ìš” ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ëŠ” ë¹„ì°¨ë‹¨ I/Oë¥¼ ì‚¬ìš©í•˜ì—¬ ë§ì€ ë™ì‹œ ì—°ê²°ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³  ì‘ì—…ì„ ë¹„ë™ê¸°ì‹(asynchronously)ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.

> ### V8 JavaScript ì—”ì§„ì— ëŒ€í•˜ì—¬
>
> ìœ„ì—ì„œ ì–¸ê¸‰í•œ ê²ƒê³¼ ê°™ì´ Node.jsëŠ” Googleì—ì„œ ê°œë°œí•˜ëŠ” V8 JavaScript ì—”ì§„ ìœ„ì— Built ë©ë‹ˆë‹¤. V8ì€ JavaScript ì½”ë“œë¥¼ ë¹ ë¥´ê³  íš¨ìœ¨ì ìœ¼ë¡œ ì‹¤í–‰í•˜ë„ë¡ ì„¤ê³„ëœ ê³ ì„±ëŠ¥ ì˜¤í”ˆ ì†ŒìŠ¤ JavaScript ì—”ì§„ì…ë‹ˆë‹¤. C++ë¡œ ì‘ì„±ë˜ì—ˆìœ¼ë©° Google Chrome ì›¹ ë¸Œë¼ìš°ì € ë° ê¸°íƒ€ ì—¬ëŸ¬ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤.
>
> V8ì€ ECMAScript ë²„ì „ 6 ì´ìƒìœ¼ë¡œ ì‘ì„±ëœ ì½”ë“œë¥¼ í¬í•¨í•˜ì—¬ ìµœì‹  JavaScript ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” Class, í™”ì‚´í‘œ í•¨ìˆ˜(Arrow Function) ë° Promise ê°™ì€ ê¸°ëŠ¥ê³¼ JIT(Just-In-Time) ì»´íŒŒì¼ì´ í¬í•¨ë˜ì–´ ëŸ°íƒ€ì„ì— ì½”ë“œë¥¼ ë„¤ì´í‹°ë¸Œ ë¨¸ì‹  ì½”ë“œë¡œ ë³€í™˜í•˜ì—¬ ì½”ë“œë¥¼ ë” ë¹ ë¥´ê²Œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
>
> V8ì€ Node.js ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‹¤í–‰ë˜ëŠ” JavaScript ì½”ë“œ ì‹¤í–‰ì„ ë‹´ë‹¹í•˜ë¯€ë¡œ Node.js ëŸ°íƒ€ì„ì˜ ì¤‘ìš”í•œ êµ¬ì„± ìš”ì†Œì…ë‹ˆë‹¤. ì´ëŠ” Node.js ëŸ°íƒ€ì„ê³¼ ê¸´ë°€í•˜ê²Œ í†µí•©ë˜ë©° Node.jsë¥¼ í™•ì¥ ê°€ëŠ¥í•œ ë„¤íŠ¸ì›Œí¬ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¶•ì— ì í•©í•˜ê²Œ ë§Œë“œëŠ” ë§ì€ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.
>
> ë‹¤ìŒì€ V8 ì—”ì§„ì˜ ì‘ë™ ë°©ì‹ì„ ê°„ëµí•˜ê²Œ ë‚˜íƒ€ë‚¸ ê²ƒì…ë‹ˆë‹¤.
>
> 1. V8 ì—”ì§„ì€ JavaScript ì½”ë“œë¥¼ ì…ë ¥ë°›ìŠµë‹ˆë‹¤.
> 1. ì½”ë“œê°€ íŒŒì‹±ë˜ê³  V8 ì—”ì§„ì´ ì´í•´í•˜ê¸° ì‰¬ìš´ ì¤‘ê°„ í‘œí˜„(IR)ìœ¼ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.
> 1. IRì€ Constant Folding, Inlining ë“± ë‹¤ì–‘í•œ ìµœì í™” ê¸°ë²•ì„ ì ìš©í•˜ì—¬ ë¹ ë¥¸ ì‹¤í–‰ì´ ê°€ëŠ¥í•˜ë„ë¡ ìµœì í™”í•©ë‹ˆë‹¤.
> 1. ìµœì í™”ëœ IRì€ JIT ì»´íŒŒì¼ëŸ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë„¤ì´í‹°ë¸Œ ì½”ë“œë¡œ ì»´íŒŒì¼ë©ë‹ˆë‹¤.
> 1. ë„¤ì´í‹°ë¸Œ ì½”ë“œëŠ” CPUì— ì˜í•´ ì‹¤í–‰ë©ë‹ˆë‹¤.

ì´ë²¤íŠ¸ ë£¨í”„ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì—¬ëŸ¬ ë‹¨ê³„ê°€ ìˆìŠµë‹ˆë‹¤.

![nodejs-eventloop.png](/nodejs-eventloop.png =700x){.align-center}

- **íƒ€ì´ë¨¸ (Timers)**: `setTimeout()` ë° `setInterval()`ì— ì˜í•´ ì˜ˆì•½ëœ ì½œë°± í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
- **ë³´ë¥˜ ì¤‘ì¸ ì½œë°± (Pending callbacks)**: Blocking ì‘ì—…ì„ ì™„ë£Œí•œ I/O ì½œë°±ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.
- **ìœ íœ´ ë° ì¤€ë¹„ (Idle, prepare)**: ì´ë²¤íŠ¸ ë£¨í”„ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë‚´ë¶€ ë‹¨ê³„ì…ë‹ˆë‹¤.
- **í´ë§ (Poll)**: ìƒˆë¡œìš´ I/O ì´ë²¤íŠ¸ë¥¼ ê²€ìƒ‰í•˜ê³  ì½œë°±ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ì²˜ë¦¬í•  I/O ì´ë²¤íŠ¸ê°€ ì—†ëŠ” ê²½ìš° ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ì´ ë‹¨ê³„ì—ì„œ Blockingë˜ê³  ìƒˆ ì´ë²¤íŠ¸ê°€ ë„ì°©í•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.
- **í™•ì¸ (Check)**: `setImmediate()`ì— ì˜í•´ ì˜ˆì•½ëœ ì½œë°±ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.
- **ì½œë°± ë‹«ê¸° (Close callbacks)**: `socket.on('close', ...)`ì— ì˜í•´ ì˜ˆì•½ëœ ê²ƒê³¼ ê°™ì€ ì½œë°± ë‹«ê¸°ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

> **ìš”ìš°ì˜ ë…¸íŠ¸ ğŸ˜**
> 
> ì´ ê³³ì—ì„œ í‘œí˜„í•œ ê° ë‹¨ê³„ì˜ í•œê¸€ëª…ì€ ê³µì‹ì ì¸ í•œê¸€ëª…ì´ ì—†ì–´ ì œê°€ ì„ì˜ë¡œ ë¶™ì¸ ê²ƒ ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ì—¬ëŸ¬ë¶„ë“¤ì€ ì˜ì–´ ì›ë¬¸ì— ìµìˆ™í•´ì§€ëŠ” ê²ƒì´ ë‚«ìŠµë‹ˆë‹¤.

ì´ë²¤íŠ¸ ë£¨í”„ì˜ ê° ë°˜ë³µì—ì„œ ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ìœ„ì—ì„œ ì„¤ëª…í•œ ë‹¨ê³„ë¥¼ ì§€ì •ëœ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤. ì´ë²¤íŠ¸ê°€ ì²˜ë¦¬ë˜ë©´ ì—°ê²°ëœ ì½œë°± í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê³  ì´ë²¤íŠ¸ê°€ ëŒ€ê¸°ì—´ì—ì„œ ì œê±°ë©ë‹ˆë‹¤.

ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ë‹¤ìŒ ì‘ì—…ìœ¼ë¡œ ì´ë™í•˜ê¸° ì „ì— ê° ì‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ì°¨ë‹¨(Blocking)í•˜ê³  ê¸°ë‹¤ë¦¬ëŠ” ëŒ€ì‹  ëŸ°íƒ€ì„ì´ ë§ì€ ì‘ì—…ì„ ë™ì‹œì— ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ë•Œë¬¸ì— Node.jsì—ì„œ ì¤‘ìš”í•œ ê°œë…ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ Node.jsë¡œ í™•ì¥ ê°€ëŠ¥í•œ ê³ ì„±ëŠ¥ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ê° ë‹¨ê³„ì— ëŒ€í•œ ìì„¸í•œ ì„¤ëª…

### íƒ€ì´ë¨¸ (Timers)

`setTimeout()` ë° `setInterval()`ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì•½ëœ ì½œë°± í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. íƒ€ì´ë¨¸ê°€ ì˜ˆì•½ë˜ë©´ íƒ€ì´ë¨¸ ëŒ€ê¸°ì—´ì— ì¶”ê°€ë˜ê³  ì§€ì •ëœ ì‹œê°„ì´ ê²½ê³¼í•˜ë©´ ì´ë²¤íŠ¸ ë£¨í”„ê°€ ì½œë°±ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ì—¬ëŸ¬ íƒ€ì´ë¨¸ê°€ ë™ì‹œì— ë§Œë£Œë˜ë„ë¡ ì˜ˆì•½ëœ ê²½ìš° ì½œë°±ì€ ëŒ€ê¸°ì—´ì— ì¶”ê°€ëœ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

> **Q. ì´ë²¤íŠ¸ ë£¨í”„ì˜ íƒ€ì´ë¨¸ê°€ ì •í™•í•œ ì‹¤í–‰ ì‹œê°„ì„ ë³´ì¥í•©ë‹ˆê¹Œ?**
>
> ì•„ë‹ˆìš”, Node.jsì—ì„œ ì´ë²¤íŠ¸ ë£¨í”„ì˜ `tick`ì€ `setTimeout()` ë° `setInterval()` ì™€ ê°™ì€ íƒ€ì´ë¨¸ í•¨ìˆ˜ì˜ ì •í™•í•œ ì‹¤í–‰ ì‹œê°„ì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
>
> Node.js ì´ë²¤íŠ¸ ë£¨í”„ì˜ `tick`ì€ ì´ë²¤íŠ¸ ë£¨í”„ì˜ ë‘ ì—°ì† ë°˜ë³µ ì‚¬ì´ì— ê°€ëŠ¥í•œ ê°€ì¥ ì‘ì€ ì§€ì—°ì„ ë‚˜íƒ€ë‚´ëŠ” ì‹œê°„ ë‹¨ìœ„ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë°€ë¦¬ì´ˆ ë˜ëŠ” ì´ˆì™€ ê°™ì´ íƒ€ì´ë¨¸ ê¸°ëŠ¥ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì‹œê°„ ë‹¨ìœ„ë³´ë‹¤ í›¨ì”¬ ì§§ìŠµë‹ˆë‹¤.
>
> ê·¸ëŸ¬ë‚˜ ì´ë²¤íŠ¸ ë£¨í”„ì˜ `tick`ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì•½ëœ ì½œë°± í•¨ìˆ˜ì˜ ì‹¤ì œ ì‹¤í–‰ ì‹œê°„ì€ ì‹œìŠ¤í…œ ë¶€í•˜ ë° ì´ë²¤íŠ¸ íì— ë‹¤ë¥¸ ì‘ì—…ì´ ì¡´ì¬í•˜ëŠ” ë“±ì˜ ìš”ì¸ìœ¼ë¡œ ì¸í•´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì´ë²¤íŠ¸ ë£¨í”„ì˜ `tick`ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì•½ëœ ì‘ì—…ì— ëŒ€í•œ ì •í™•í•œ ì‹¤í–‰ ì‹œê°„ì„ ë³´ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
>
> ì¼ë°˜ì ìœ¼ë¡œ ì´ë¡œ ì¸í•œ íƒ€ì´ë° ì˜¤ë¥˜ëŠ” ëŒ€ë¶€ë¶„ì˜ ì‘ìš© í”„ë¡œê·¸ë¨ì—ì„œ ì‘ì€ ì˜í–¥ì„ ë¼ì¹˜ë©°, ëˆˆì— ë³´ì´ì§€ ì•ŠìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ íŠ¹ì • ì‹œê°„, ë˜ëŠ” íŠ¹ì • ìˆ˜ì¤€ì˜ ì •í™•ë„ë¡œ ì‘ì—…ì„ ì‹¤í–‰í•´ì•¼ í•˜ëŠ” ê²½ìš° ì´ë²¤íŠ¸ ë£¨í”„ì˜ íƒ€ì´ë¨¸ ê¸°ëŠ¥ê³¼ ì´ë²¤íŠ¸ ë£¨í”„ì˜ `tick` ê¸°ëŠ¥ì´ ì‚¬ìš©ìì˜ ìš”êµ¬ì— ì í•©í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒì„ ì¸ì‹í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.
>
> ì´ëŸ¬í•œ ê²½ìš° í•˜ë“œì›¨ì–´ íƒ€ì´ë¨¸ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ ìì²´ íƒ€ì´ë° ë©”ì»¤ë‹ˆì¦˜ì„ êµ¬í˜„í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ë‹¤ë¥¸ ì ‘ê·¼ ë°©ì‹ì„ ì‚¬ìš©í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìš”êµ¬ ì‚¬í•­ê³¼ í•„ìš”í•œ ì •í™•ë„ ìˆ˜ì¤€ì„ ì‹ ì¤‘í•˜ê²Œ ê³ ë ¤í•˜ì—¬ ì ì ˆí•œ ì ‘ê·¼ ë°©ì‹ì„ ì„ íƒí•˜ëŠ” ê²ƒë„ ì¤‘ìš”í•©ë‹ˆë‹¤.

### ë³´ë¥˜ ì¤‘ì¸ ì½œë°± (Pending callbacks)

íŒŒì¼ ì½ê¸° ë˜ëŠ” HTTP ìš”ì²­ ìƒì„±ì™€ ê°™ì€ ì°¨ë‹¨(Blocking) ì‘ì—…ì„ ì™„ë£Œí•œ ì½œë°±ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì½œë°±ì€ ì°¨ë‹¨ ì‘ì—…ì´ ì‹œì‘ë  ë•Œ Node.js ëŸ°íƒ€ì„ì— ì˜í•´ "ë³´ë¥˜ ì¤‘ì¸ ì½œë°±" ëŒ€ê¸°ì—´ì— ì¶”ê°€ë˜ë©° ëŒ€ê¸°ì—´ì— ì¶”ê°€ëœ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

### ìœ íœ´ ë° ì¤€ë¹„ (Idle, prepare)

íŒŒì¼ ì‹œìŠ¤í…œ ì´ë²¤íŠ¸ì— ëŒ€í•œ Watcher ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ë° ë‚´ë¶€ ë°ì´í„° êµ¬ì¡° ì •ë¦¬ì™€ ê°™ì€ ë‹¤ì–‘í•œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì´ë²¤íŠ¸ ë£¨í”„ì˜ ë‚´ë¶€ ë‹¨ê³„ì…ë‹ˆë‹¤.

> **Q. ì´ë²¤íŠ¸ ë£¨í”„ì˜ "ìœ íœ´ ë° ì¤€ë¹„ (Idle, prepare)" ë‹¨ê³„ì—ì„œëŠ” ì–´ë–¤ ì¼ì´ ë°œìƒí•©ë‹ˆê¹Œ?**
>
> Node.js ì´ë²¤íŠ¸ ë£¨í”„ì˜ "Idle, prepare" ë‹¨ê³„ì—ì„œ ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ë‹¤ìŒ ë°˜ë³µì„ ìœ„í•´ ì˜ˆì•½í•´ì•¼ í•˜ëŠ” ëª¨ë“  ì‘ì—…ì„ í™•ì¸í•©ë‹ˆë‹¤.
>
> Node.jsì˜ ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ê°ê° íŠ¹ì • ìœ í˜•ì˜ ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ” ì¼ë ¨ì˜ ë‹¨ê³„ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. "Idle, prepare" ë‹¨ê³„ëŠ” ì´ë²¤íŠ¸ ë£¨í”„ì˜ ì²« ë²ˆì§¸ ë‹¨ê³„ì´ë©° "Poll" ë‹¨ê³„, "Check" ë‹¨ê³„ ë° "Close callbacks" ë‹¨ê³„ê°€ ë’¤ë”°ë¦…ë‹ˆë‹¤.
>
> "Idle, prepare" ë‹¨ê³„ì—ì„œ ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ë‹¤ìŒ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
>
> - `process.nextTick()` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì•½ëœ ëª¨ë“  ì‘ì—…ì„ í™•ì¸í•˜ê³  ì´ë²¤íŠ¸ ë£¨í”„ì˜ ë‹¤ìŒ ë°˜ë³µì—ì„œ ì‹¤í–‰í•  ì´ë²¤íŠ¸ë¥¼ íì— ì¶”ê°€í•©ë‹ˆë‹¤.
> - Rejected ë˜ì—ˆê±°ë‚˜ Error Handlerê°€ ì—†ëŠ” ëª¨ë“  `Promise` ê°œì²´ë¥¼ í™•ì¸í•˜ê³  Rejection handlingì´ ì´ë²¤íŠ¸ ë£¨í”„ì˜ ë‹¤ìŒ ë°˜ë³µì—ì„œ ìˆ˜í–‰ë˜ë„ë¡ ì˜ˆì•½í•©ë‹ˆë‹¤.
> - ë§Œë£Œëœ íƒ€ì´ë¨¸(`setTimeout()` ë˜ëŠ” `setInterval()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¤ì •ëœ íƒ€ì´ë¨¸)ë¥¼ í™•ì¸í•˜ê³  ì´ë²¤íŠ¸ ë£¨í”„ì˜ ë‹¤ìŒ ë°˜ë³µì—ì„œ ì‹¤í–‰ë  ì½œë°± í•¨ìˆ˜ë¥¼ ì´ë²¤íŠ¸ íì— ì¶”ê°€í•©ë‹ˆë‹¤.
>
> ì´ëŸ¬í•œ ì‘ì—…ì´ ì™„ë£Œë˜ë©´ ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ë‹¤ìŒ ë‹¨ê³„ì¸ "Poll" ë‹¨ê³„ë¡œ ì´ë™í•˜ì—¬ ìƒˆ ì´ë²¤íŠ¸ê°€ ë„ì°©í•˜ê±°ë‚˜ ì´ì „ì— ì˜ˆì•½ëœ ì‘ì—…ì´ ì‹¤í–‰ ì¤€ë¹„ê°€ ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.

### í´ë§ (Poll)

ìƒˆ ì´ë²¤íŠ¸ê°€ ë„ì°©í•˜ê±°ë‚˜ ì´ì „ì— ì˜ˆì•½ëœ ì‘ì—…ì´ ì‹¤í–‰ ì¤€ë¹„ê°€ ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤. ì´ë²¤íŠ¸ ë£¨í”„ëŠ” `poll()`, `epoll()` ë˜ëŠ” `kqueue()`ì™€ ê°™ì€ ë‚´ë¶€ ë©”ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ë“±ë¡ëœ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ì†ŒìŠ¤ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê³  ì´ë²¤íŠ¸ê°€ ë°œìƒí•  ë•Œ ì•Œë¦¼ì„ ë°›ìŠµë‹ˆë‹¤.

ìƒˆ ì´ë²¤íŠ¸ ë˜ëŠ” ì‘ì—…ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²½ìš° ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ì´ë²¤íŠ¸ íì—ì„œ ì´ë¥¼ ê²€ìƒ‰í•˜ê³  ì´ë²¤íŠ¸ ë£¨í”„ì˜ ë‹¤ìŒ ë°˜ë³µì—ì„œ ì²˜ë¦¬í•  "í™•ì¸ (Check)" ë‹¨ê³„ íì— ì¶”ê°€í•©ë‹ˆë‹¤.

ì´ë²¤íŠ¸ íê°€ ë¹„ì–´ ìˆê³  ì²˜ë¦¬í•  ì´ë²¤íŠ¸ë‚˜ ì‘ì—…ì´ ë” ì´ìƒ ì—†ìœ¼ë©´ ì´ë²¤íŠ¸ ë£¨í”„ëŠ” "ëŒ€ê¸° (Waiting)" ìƒíƒœê°€ ë˜ì–´ ìƒˆ ì´ë²¤íŠ¸ë‚˜ ì‘ì—…ì´ ë„ì°©í•˜ê¸°ë¥¼ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.

ì´ë²¤íŠ¸ ë£¨í”„ê°€ "í´ë§(Poll)" ë‹¨ê³„ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  ì´ë²¤íŠ¸ ë° ì‘ì—… ì²˜ë¦¬ë¥¼ ë§ˆì¹˜ë©´ ë‹¤ìŒ ë‹¨ê³„ì¸ "í™•ì¸ (Check)" ë‹¨ê³„ë¡œ ì´ë™í•˜ì—¬ ì´ë²¤íŠ¸ ë£¨í”„ì˜ í˜„ì¬ ë°˜ë³µì— ëŒ€í•´ ì˜ˆì•½ëœ ëª¨ë“  ì‘ì—…ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.

### í™•ì¸ (Check)

`setImmediate()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì•½ëœ ì½œë°±ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì½œë°±ì€ "í™•ì¸ (Check)" ëŒ€ê¸°ì—´ì— ì¶”ê°€ë˜ê³  ëŒ€ê¸°ì—´ì— ì¶”ê°€ëœ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

### ì½œë°± ë‹«ê¸° (Close callbacks)

`socket.on('close', ...)`ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì•½ëœ ì½œë°±ê³¼ ê°™ì€ ë‹«ê¸° ì½œë°±ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì½œë°±ì€ ì†Œì¼“ì´ë‚˜ ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ê°€ ë‹«í ë•Œ ì‹¤í–‰ë˜ë©° ì¼ë°˜ì ìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ ì •ë¦¬í•˜ê±°ë‚˜ ë¦¬ì†ŒìŠ¤ ë‹«ê¸°ì™€ ê´€ë ¨ëœ ë‹¤ë¥¸ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

## ì´ë²¤íŠ¸ ë£¨í”„ ì˜ˆì œ

```js
setTimeout(function() {
  console.log('Timeout callback');
}, 1000);

console.log('Start');

// "Start" ë¨¼ì € ì¶œë ¥ëœ í›„ 1ì´ˆ ë’¤ "Timeout callback" ì¶œë ¥
```

ì´ ì˜ˆì œì—ì„œëŠ” `setTimeout()`ì„ ì‚¬ìš©í•˜ì—¬ 1ì´ˆ(1000ë°€ë¦¬ì´ˆ) í›„ì— ì‹¤í–‰ë˜ë„ë¡ ì½œë°± í•¨ìˆ˜ë¥¼ ì˜ˆì•½í•©ë‹ˆë‹¤. ì´ë²¤íŠ¸ ë£¨í”„ëŠ” 1ì´ˆê°€ ê²½ê³¼í•œ í›„ "íƒ€ì´ë¨¸" ë‹¨ê³„ì— ë“¤ì–´ê°€ê³  ì½œë°± í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

---


```js
const fs = require('fs');

fs.readFile('file.txt', function(err, data) {
  console.log('File read callback');
});

console.log('Start');
// "Start" ë¨¼ì € ì¶œë ¥ëœ í›„ íŒŒì¼ ì½ê¸°ê°€ ì™„ë£Œë˜ë©´ "File read callback" ì¶œë ¥
```

ì´ ì˜ˆì œì—ì„œëŠ” fs ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ì„ ì½ì–´ Blocking I/O ì‘ì—…ì„ ì‹œì‘í•©ë‹ˆë‹¤. íŒŒì¼ ì½ê¸° ì‘ì—…ì´ ì™„ë£Œë˜ë©´ ì½œë°± í•¨ìˆ˜ê°€ "ë³´ë¥˜ ì¤‘ì¸ ì½œë°±" ëŒ€ê¸°ì—´ì— ì¶”ê°€ë˜ê³  ë‹¤ìŒ ë°˜ë³µì—ì„œ ì´ë²¤íŠ¸ ë£¨í”„ì— ì˜í•´ ì‹¤í–‰ë©ë‹ˆë‹¤.

---

```js
setImmediate(function() {
  console.log('Immediate callback');
});

console.log('Start');

// "Start" ë¨¼ì € ì¶œë ¥ëœ í›„ ë°”ë¡œ "Imediate callback" ì¶œë ¥
```

ì´ ì˜ˆì œì—ì„œëŠ” ê°€ëŠ¥í•œ í•œ ë¹¨ë¦¬ ì‹¤í–‰ë˜ë„ë¡ `setImmediate()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì½œë°± í•¨ìˆ˜ë¥¼ ì˜ˆì•½í•©ë‹ˆë‹¤. ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ë‹¤ìŒ ë°˜ë³µì—ì„œ "í™•ì¸" ë‹¨ê³„ì— ì§„ì…í•˜ê³  ì½œë°± í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

## Deep dive with pseudo code

```js
const fs = require('fs');

// ë³´ë¥˜ ì¤‘ì¸ ì½œë°±
const pendingCallbacks = [];

// íƒ€ì´ë¨¸
const timers = [];

// SetImmediate ì½œë°±
const immediateCallbacks = [];

// ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì— ëŒ€í•œ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°ì˜ ë§µ
const fdHandlers = new Map();

// ì²˜ë¦¬í•  íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ì´ë²¤íŠ¸ í
const fdEvents = [];

// ë³´ë¥˜ ì¤‘ì¸ ì½œë°± íì— ì½œë°±ì„ ì¶”ê°€
function addPendingCallback(callback) {
  pendingCallbacks.push(callback);
}

// íƒ€ì´ë¨¸ íì— ì½œë°±ì„ ì¶”ê°€
function addTimer(callback, timeout) {
  const expiration = Date.now() + timeout;
  timers.push({ callback, expiration });
  timers.sort((a, b) => a.expiration - b.expiration);
}
// SetImmediate íì— ì½œë°±ì„ ì¶”ê°€
// Add a SetImmediate callback to the queue
function addImmediateCallback(callback) {
  immediateCallbacks.push(callback);
}

// íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°ì— ëŒ€í•œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€
function addFdHandler(fd, handler) {
  fdHandlers.set(fd, handler);
}

// íì— íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ì´ë²¤íŠ¸ ì¶”ê°€
function addFdEvent(fd, eventType) {
  fdEvents.push({ fd, eventType });
}

// ë©”ì¸ ì´ë²¤íŠ¸ ë£¨í”„
function eventLoop() {
  // ë³´ë¥˜ ì¤‘ì¸ ì½œë°±ì„ ì‹¤í–‰
  while (pendingCallbacks.length > 0) {
    const callback = pendingCallbacks.shift();
    callback();
  }

  // ë§Œë£Œëœ íƒ€ì´ë¨¸ ì‹¤í–‰
  const now = Date.now();
  while (timers.length > 0 && timers[0].expiration <= now) {
    const timer = timers.shift();
    timer.callback();
  }

  // ëª¨ë“  SetImmediate ì½œë°± ì‹¤í–‰
  while (immediateCallbacks.length > 0) {
    const callback = immediateCallbacks.shift();
    callback();
  }

  // ëª¨ë“  íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ì´ë²¤íŠ¸ ì²˜ë¦¬
  while (fdEvents.length > 0) {
    const { fd, eventType } = fdEvents.shift();
    const handler = fdHandlers.get(fd);
    if (handler) {
      handler(fd, eventType);
    }
  }

  // ìƒˆë¡œìš´ ì´ë²¤íŠ¸ ë„ì°© ëŒ€ê¸°
  waitForEvents();
}

// ìƒˆë¡œìš´ ì´ë²¤íŠ¸ ë„ì°© ëŒ€ê¸°
function waitForEvents() {
   // epoll() ë˜ëŠ” select()ì™€ ê°™ì€ Blocking System call ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ì´ë²¤íŠ¸ë¥¼ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.
   // ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì„ ë•Œ ì ì ˆí•œ íì— ì¶”ê°€í•©ë‹ˆë‹¤(ë³´ë¥˜ ì¤‘ì¸ ì½œë°±, íƒ€ì´ë¨¸ ë“±).
   // ê·¸ë¦¬ê³  process.nextTick()ì„ ì‚¬ìš©í•˜ì—¬ ì´ë²¤íŠ¸ ë£¨í”„ê°€ ë‹¤ì‹œ ì‹¤í–‰ë˜ë„ë¡ ì˜ˆì•½í•©ë‹ˆë‹¤.
}

// ì´ë²¤íŠ¸ ë£¨í”„ ì‹¤í–‰
function run() {
  process.nextTick(eventLoop);
}

run();

// ì‚¬ìš© ì˜ˆì œ
fs.readFile('file.txt', function(err, data) {
  addPendingCallback(function() {
    console.log('File read callback');
  });
});

addTimer(function() {
  console.log('Timeout callback');
}, 1000);

setImmediate(function() {
  console.log('Immediate callback');
});
```

ì´ ì½”ë“œëŠ” ë‹¤ì–‘í•œ ìœ í˜•ì˜ ì´ë²¤íŠ¸ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ë°°ì—´ê³¼ ë§µì„ ì •ì˜í•©ë‹ˆë‹¤.

- `pendingCallbacks`: Blocking ì‘ì—…ì„ ì™„ë£Œí•˜ê³  ì‹¤í–‰í•  ì¤€ë¹„ê°€ ëœ ì½œë°±ì˜ ë°°ì—´ì…ë‹ˆë‹¤.
- `timers`: `setTimeout()` ë˜ëŠ” `setInterval()`ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì•½ëœ íƒ€ì´ë¨¸ ë°°ì—´ì…ë‹ˆë‹¤.
- `immediateCallbacks`: `setImmediate()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì•½ë˜ê³  ì‹¤í–‰í•  ì¤€ë¹„ê°€ ëœ ì½œë°±ì˜ ë°°ì—´ì…ë‹ˆë‹¤.
- `fdHandlers`: ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì— ëŒ€í•œ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°ì˜ ë§µì…ë‹ˆë‹¤.
- `fdEvents`: ì²˜ë¦¬í•  ì¤€ë¹„ê°€ ëœ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ì´ë²¤íŠ¸ì˜ ë°°ì—´ì…ë‹ˆë‹¤.

ì´ ì½”ë“œëŠ” ë˜í•œ ë°°ì—´ ë° ë§µì— ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€í•˜ëŠ” ì—¬ëŸ¬ í•¨ìˆ˜ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

- `addPendingCallback(callback)`: `pendingCallbacks` ë°°ì—´ì— ì½œë°±ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
- `addTimer(callback, timeout)`: `timers` ë°°ì—´ì— íƒ€ì´ë¨¸ ì½œë°±ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
- `addImmediateCallback(callback)`: `immediateCallbacks` ë°°ì—´ì— ì½œë°±ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
- `addFdHandler(fd, handler)`: íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°ì— ëŒ€í•œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ `fdHandlers` ë§µì— ì¶”ê°€í•©ë‹ˆë‹¤.
- `addFdEvent(fd, eventType)`: íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ì´ë²¤íŠ¸ë¥¼ `fdEvents` ë°°ì—´ì— ì¶”ê°€í•©ë‹ˆë‹¤.

ë©”ì¸ ì´ë²¤íŠ¸ ë£¨í”„ëŠ” `eventLoop()` í•¨ìˆ˜ì—ì„œ ì •ì˜ë©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ë‹¤ìŒ ìˆœì„œë¡œ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.

- **Pending callbacks**: `pendingCallbacks` ë°°ì—´ì˜ ì½œë°±ì€ ì¶”ê°€ëœ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.
- **Timer**: `timers` ë°°ì—´ì˜ íƒ€ì´ë¨¸ ì½œë°±ì€ ì¶”ê°€ëœ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.
- **SetImmediate callbacks**: `immediateCallbacks` ë°°ì—´ì˜ ì½œë°±ì€ ì¶”ê°€ëœ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.
- **File descriptor events**: `fdEvents` ë°°ì—´ì˜ ì´ë²¤íŠ¸ëŠ” `fdHandlers` ë§µì—ì„œ í•´ë‹¹ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰í•˜ì—¬ ì²˜ë¦¬ë©ë‹ˆë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ `waitForEvents()` í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì–´ ìƒˆ ì´ë²¤íŠ¸ê°€ ë„ì°©í•˜ê¸°ë¥¼ ê¸°ë‹¤ë¦½ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” `setTimeout()`ì„ ì‚¬ìš©í•˜ê±°ë‚˜ Linuxì—ì„œ `epoll()`ê³¼ ê°™ì€ ì°¨ë‹¨ ì‹œìŠ¤í…œ í˜¸ì¶œì„ ì‚¬ìš©í•˜ëŠ” ë“±ì˜ ë‹¤ì–‘í•œ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> ### Linuxì˜ epoll() í•¨ìˆ˜ì— ëŒ€í•˜ì—¬
>
> `epoll`ì€ í™•ì¥ ê°€ëŠ¥í•œ I/O ì´ë²¤íŠ¸ ì•Œë¦¼ ë©”ì»¤ë‹ˆì¦˜ì„ ì œê³µí•˜ëŠ” Linux ì»¤ë„ ì‹œìŠ¤í…œ ì½œì…ë‹ˆë‹¤. ë°ì´í„° ê°€ìš©ì„± ë˜ëŠ” ì—°ê²° ì¤€ë¹„ì™€ ê°™ì€ ì´ë²¤íŠ¸ì— ëŒ€í•œ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ì§‘í•©ì„ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë° ì‚¬ìš©ë˜ë©° ë„¤íŠ¸ì›Œí¬ ì‘ìš© í”„ë¡œê·¸ë¨ì—ì„œ íš¨ìœ¨ì ì¸ I/O ë‹¤ì¤‘í™”ë¥¼ êµ¬í˜„í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
>
> `epoll`ì€ ì—ì§€ íŠ¸ë¦¬ê±°(edge-triggered) ë˜ëŠ” ë ˆë²¨ íŠ¸ë¦¬ê±°(level-triggerd)ì˜ ë‘ ê°€ì§€ ëª¨ë“œ ì¤‘ í•˜ë‚˜ë¡œ ì‘ë™í•©ë‹ˆë‹¤. ì—ì§€ íŠ¸ë¦¬ê±° ëª¨ë“œì—ì„œëŠ” íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°ì˜ ìƒíƒœê°€ ë³€ê²½ë  ë•Œë§Œ ì´ë²¤íŠ¸ê°€ ìƒì„±ë©ë‹ˆë‹¤. ë ˆë²¨ íŠ¸ë¦¬ê±° ëª¨ë“œì—ì„œëŠ” ë°ì´í„°ë¥¼ ì½ì„ ìˆ˜ ìˆëŠ” ê²½ìš°ì™€ ê°™ì´ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°ê°€ íŠ¹ì • ìƒíƒœì— ìˆì„ ë•Œë§ˆë‹¤ ì´ë²¤íŠ¸ê°€ ìƒì„±ë©ë‹ˆë‹¤.
>
> `epoll`ì€ ì¢…ì¢… `select()` ì‹œìŠ¤í…œ í˜¸ì¶œê³¼ í•¨ê»˜ ì‚¬ìš©ë˜ì–´ í”„ë¡œê·¸ë¨ì´ ì´ë²¤íŠ¸ì— ëŒ€í•œ ì—¬ëŸ¬ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°ë¥¼ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. `epoll`ì€ ë§ì€ ìˆ˜ì˜ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë³´ë‹¤ íš¨ìœ¨ì ì¸ ë°©ë²•ì„ ì œê³µí•˜ë©° íŠ¹íˆ ë†’ì€ ë™ì‹œì„± ì„œë²„ì— ìœ ìš©í•©ë‹ˆë‹¤.
>
> Node.jsì—ì„œ ì‚¬ìš©í•˜ëŠ” í¬ë¡œìŠ¤ í”Œë«í¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ `libuv`ëŠ” `epoll` ë° ê¸°íƒ€ í”Œë«í¼ë³„ APIì— ëŒ€í•œ ë˜í¼ë¥¼ ì œê³µí•˜ì—¬ ë¹„ë™ê¸°ì‹ I/O ì‘ì—…ì„ ìœ„í•œ ì¼ê´€ëœ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ Node.js ì• í”Œë¦¬ì¼€ì´ì…˜ì€ `epoll` ì‹œìŠ¤í…œ í˜¸ì¶œì„ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ì•Šê³ ë„ Linuxì—ì„œ `epoll`ì˜ í™•ì¥ì„±ê³¼ íš¨ìœ¨ì„±ì„ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
>
> MacOS/BSDì—ëŠ” `epoll` ê³¼ ë™ì¼í•œ ì—­í• ì„ í•˜ëŠ” `kqueue()`ê°€ ìˆê³ , Windows ì—ëŠ” `IOCP`(Input/Output Completion Ports)ê°€ ìˆìŠµë‹ˆë‹¤.

> ### libuvì— ëŒ€í•˜ì—¬
>
> libuvëŠ” ë¹„ë™ê¸° I/O ë° ê¸°íƒ€ ìœ í‹¸ë¦¬í‹° ê¸°ëŠ¥ì„ ì§€ì›í•˜ëŠ” í¬ë¡œìŠ¤ í”Œë«í¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. Node.jsì˜ ê¸°ë³¸ í”Œë«í¼ ê³„ì¸µìœ¼ë¡œ ì‚¬ìš©ë˜ë©° Node.js ëŸ°íƒ€ì„ì—ì„œ ì´ë²¤íŠ¸ ë£¨í”„ ë° ê¸°íƒ€ ë¹„ë™ê¸° ë©”ì»¤ë‹ˆì¦˜ êµ¬í˜„ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.
>
> libuvëŠ” Cì–¸ì–´ë¡œ ì‘ì„±ë˜ì—ˆìœ¼ë©° íŒŒì¼ I/O, ë„¤íŠ¸ì›Œí¬ ì‘ì—…, íƒ€ì´ë¨¸ ë° í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ì™€ ê°™ì€ ë‹¤ì–‘í•œ ìœ í˜•ì˜ ë¹„ë™ê¸° ì‘ì—…ì„ ìœ„í•œ ì¼ê´€ëœ APIë¥¼ ì œê³µí•©ë‹ˆë‹¤. Linuxì˜ `epoll` ë° macOSì˜ `kqueue`ì™€ ê°™ì€ ë‹¤ì–‘í•œ í”Œë«í¼ë³„ API ê°„ì˜ ì°¨ì´ì ì„ ì¶”ìƒí™”í•˜ì—¬ ì—¬ëŸ¬ ìš´ì˜ ì²´ì œì—ì„œ ì‘ë™í•˜ëŠ” êµì°¨ í”Œë«í¼ ì½”ë“œë¥¼ ë” ì‰½ê²Œ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
>
> libuvëŠ” Node.js ëŸ°íƒ€ì„ì˜ ì¤‘ìš”í•œ êµ¬ì„± ìš”ì†Œì´ë©° Node.jsê°€ í™•ì¥ ê°€ëŠ¥í•œ ë„¤íŠ¸ì›Œí¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•˜ëŠ” ë° ì í•©í•˜ë„ë¡ ë§Œë“œëŠ” ë§ì€ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## More

- [The Node.js Event Loop, Timers, and process.nextTick()*nodejs.org*](https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/)
{.links-list}